var page,jQ={},admin={},common={};$(document).ready(function(){page=$("#page").attr("page"),win.init($("#great-gatsby"),$("#great-gatsby #window")),$(window).resize(function(){win.resize()}),common.init(),admin.init()}),admin.init=function(){common.menu.init(),admin[page]?"function"==typeof admin[page].init?(admin[page].init(),console.log("success :: admin."+page+".init()")):console.error("error :: function admin."+page+".init() is not defined"):console.error("error :: cannot find admin."+page+".init()")},admin.categories={},admin.categories.init=function(){jQ.categories=$("#categories"),jQ.trAddButton=jQ.categories.find(".category-add").closest("tr"),loadmore.init("category_order",0,16,function(a){var b;$.each(a,function(a,c){b=admin.categories.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.categories.createElement(c),$(".admin-table tbody").append(b)})}),jQ.categories.sortable({items:"tbody tr:not(.no-sortable)",handle:".move",placeholder:"ui-state-highlight"}),jQ.categories.disableSelection(),$(document).on("mouseup",function(a){var b=$(a.target);b.is(".move")&&admin.categories.move()})},admin.categories.createElement=function(a){var b;return b='<tr class="category" data-id="'+a.category_id+'">',b+='<td class="move" title="\u0414\u0432\u0438\u0433\u0430\u0439\u0442\u0435 \u0437\u0430 \u044d\u0442\u0438 \u0441\u0442\u0440\u0435\u043b\u043a\u0438 \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043c\u0435\u0441\u0442\u0430\u043c\u0438"></td>',b+='<td class="order">'+a.category_order+"</td>",b+='<td class="category-name" data-id="'+a.category_id+'"><input maxlength=40 value="'+a.category_name+'"></td>',b+='<td class="category-url"><input value="'+a.category_url+'"></td>',b+='<td class="options"><div class="remove">&#215;</div></td>',b+="</tr>"},admin.categories.add=function(){var a="categories",b="add",c={};c.order=$("#category-add-table input[name=order]").val(),c.name=$("#category-add-table input[name=name]").val(),c.url=$("#category-add-table input[name=url]").val(),common.ajax({"with":a,what:b,category:c},function(a){if(0!=a){var b="";b+='<tr class="category" data-id="'+a.id+'">',b+='<td class="move"></td>',b+='<td class="order">'+a.id+"</td>",b+='<td class="category-name">',b+='<input value="'+a.name+'">',b+="</td>",b+='<td class="category-url">',b+='<input value="'+a.url+'">',b+="</td>",b+='<td class="options">',b+='<div class="remove">&#215;</div>',b+="</td>",b+="</tr>",win.hide(),$(".admin-table tbody").append(b),admin.categories.move(),console.log("OK :: admin.categories.add")}else console.error("error :: try to add category with wrong request")})},admin.categories.move=function(){var a=[];setTimeout(function(){$(".order").each(function(b){a[b]=$(this).closest("tr").data("id")}),common.ajax({"with":"categories",what:"order",ids:a},function(a){a.fail?console.log(a.fail):($(".order").css({opacity:"0"}).animate({opacity:1}),$(".order").each(function(a){$(this).html(a+1)}))})},200)},admin.products={},admin.products.categories="",admin.products.sortById=function(){$(".admin-table tbody").empty(),loadmore.init("product_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})})},admin.products.sortByCategory=function(){$(".admin-table tbody").empty(),loadmore.init("category_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})})},admin.products.sortBySubcategory=function(){$(".admin-table tbody").empty(),loadmore.init("product_subcategory_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.products.createElement(c),$(".admin-table tbody").append(b)})})},admin.products.selectCategory=function(a){var b;return b="<select>",$.each(admin.products.categories,function(c,d){b+='<option class="product-category-option" value="'+d.category_id+'"',a==d.category_id&&(b+=' selected="selected"'),b+=">"+d.category_name+"</option>"}),b+="</select>"},admin.products.selectSubcategory=function(a,b){var c="<select>",d=!1;return b?($.each(admin.products.cats,function(e,f){f.category_id==a&&(d=!0,c+='<option class="product-subcategory-option" value="'+f.subcategory_id+'"',b==f.subcategory_id&&(c+=' selected="selected"'),c+=">"+f.subcategory_name+"</option>")}),d||(c="<select disabled>",c+='<option class="product-subcategory-option"',c+=' selected="selected"',c+=">\u041d\u0435\u0442 \u043f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439</option>")):(c+='<option class="product-subcategory-option"',c+=' selected="selected"',c+=" disabled>\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435</option>",$.each(admin.products.cats,function(b,e){e.category_id==a&&(d=!0,c+='<option class="product-subcategory-option" value="'+e.subcategory_id+'"',c+=">"+e.subcategory_name+"</option>")}),d||(c="<select disabled>",c+='<option class="product-subcategory-option"',c+=' selected="selected"',c+=">\u041d\u0435\u0442 \u043f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439</option>")),c+="</select>"},admin.products.cats={},admin.products.init=function(){jQ.products=$("#products"),jQ.trAddButton=jQ.products.find(".product-add").closest("tr"),common.ajax({"with":"categories",what:"get-all"},function(a){admin.products.categories=a,common.ajax({"with":"products",what:"get-cats"},function(a){a.success&&(console.log("admin.products.init :: admin.products.cats : success"),admin.products.cats=a.success)},!1,"admin.products.init"),admin.products.sortById()})},admin.products.createElement=function(a){var b;return b='<tr class="product" data-id="'+a.product_id+'">',b+='<td class="product-name"><input maxlength=40 value="'+a.product_name+'"></td>',b+='<td class="product-id"><input disabled value="'+a.product_id,b+=a.product_name.substr(0,2).toUpperCase()+'"></td>',console.log(a),b+='<td class="product-category" data-id="'+a.category_id+'">',b+=admin.products.selectCategory(a.category_id),b+="</td>",b+='<td class="product-subcategory" data-id="'+a.product_subcategory_id+'">',b+=admin.products.selectSubcategory(a.category_id,a.product_subcategory_id),b+="</td>",b+='<td class="product-type"><select>',b+='<option value="default"',"default"==a.product_type&&(b+=' selected="selected"'),b+=">\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e</option>",b+='<option value="hit"',"hit"==a.product_type&&(b+=' selected="selected"'),b+=">\u0425\u0438\u0442 \u043f\u0440\u043e\u0434\u0430\u0436</option>",b+='<option value="actia"',"actia"==a.product_type&&(b+=' selected="selected"'),b+=">\u0410\u043a\u0446\u0438\u044f</option>",b+='<option value="discount"',"discount"==a.product_type&&(b+=' selected="selected"'),b+=">\u0421\u043a\u0438\u0434\u043a\u0430</option>",b+="</select></td>",b+='<td class="product-price"><input type="number" value="'+a.product_price+'"></td>',b+='<td class="product-old-price"><input type="number" ',b+="discount"!=a.product_type?'disabled value="'+a.product_price+'"':' value="'+a.product_old_price,b+='"></td>',b+='<td class="product-images"></td>',b+='<td class="options"><div class="remove">&#215;</div></td>',b+='<td class="details product-details">...</td>',b+="</tr>"},admin.products.add=function(){var a={};a.name=$("#product-add-table input[name=name]").val(),a.price=$("#product-add-table input[name=price]").val(),a.category=$("#product-add-table select[name=category] option:selected").val(),a.type="default",common.ajax({"with":"products",what:"add",product:a},function(a){if(0!=a){var b=admin.products.createElement(a);$(".admin-table tbody").prepend(b),win.hide()}else console.error("error :: try to add product with wrong request")})},admin.products.removeProductImage=function(a){var b={"with":"products",what:"remove-image",image:a.data("image"),id:a.data("id")};common.ajax(b,function(b){"true"==b.success?a.closest(".carousel-block").remove():(console.log(b),alert("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c"))},function(){alert("\u041d\u0435 \u0443\u0434\u0430\u0451\u0442\u0441\u044f \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443")},"admin.products.removeProductImage")},admin.products.setMainImage=function(a){var b="admin.products.setMainImage",c=a.data("id"),d={"with":"products",what:"set-main-image",image:a.data("image"),id:c};common.ajax(d,function(d){"true"==d.success?($(".already-main").removeClass("already-main").addClass("set-main-image"),$(".already-main").attr("title","\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0433\u043b\u0430\u0432\u043d\u044b\u043c"),a.removeClass("set-main-image").addClass("already-main"),a.attr("title","\u042d\u0442\u043e \u0433\u043b\u0430\u0432\u043d\u043e\u0435 \u0444\u043e\u0442\u043e \u0442\u043e\u0432\u0430\u0440\u0430"),admin.products.images(c)):console.log(b+" :: "+d)},function(){console.log(b+" :: ajax-error")},b)},admin.products.setSecondImage=function(a){var b="admin.products.setSecondImage",c=a.data("id"),d={"with":"products",what:"set-second-image",image:a.data("image"),id:c};common.ajax(d,function(d){"true"==d.success?($(".already-second").removeClass("already-second").addClass("set-second-image"),$(".already-second").attr("title","\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0432\u0442\u043e\u0440\u044b\u043c"),a.removeClass("set-second-image").addClass("already-second"),a.attr("title","\u042d\u0442\u043e \u0432\u0442\u043e\u0440\u043e\u0435 \u0444\u043e\u0442\u043e \u0442\u043e\u0432\u0430\u0440\u0430"),admin.products.images(c)):console.log(b+" :: "+d)},function(){console.log(b+" :: ajax-error")},b)},admin.products.images=function(a){var b="products",c="details";$("#product-details"),$("#product-images #product-images-box").empty(),win.show(function(){win.title.set($("#msg-product-images-title").text()),win.content.set($("#msg-product-images-body"))}),$("#images-loading").show(),common.ajax({"with":b,what:c,id:a},function(b){$("#images-loading").hide(),$("#product-images #product-id").val(a);var c="";c+='<div class="carousel-button-left"><a></a></div>',c+='<div class="carousel">',c+='<div class="carousel-wrapper">',c+='<div class="carousel-items">';for(var d=0;d<b.product_images.length;d++){var e=b.product_cut_images[d].replace("..!","").replace("..$","");c+='<div class="carousel-block">',"/site/gcorp/images/products/no-image.png"!=b.product_images[d]&&(c+='<span title="\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442" class="image-color filter-color color-',c+=b.product_picture_color[e],c+='" data-color="',c+=b.product_picture_color[e],c+='" data-product="',c+=b.product_id,c+='" data-image="',c+=e,c+='"',c+="></span>",c+='<div class="product-image-remove" data-image="'+e+'" data-id="'+a+'" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"></div>',c+=0!=d?'<div class="set-main-image" title="\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0433\u043b\u0430\u0432\u043d\u044b\u043c" data-image="'+b.product_cut_images[d]+'" data-id="'+a+'">1</div>':'<div class="already-main" title="\u042d\u0442\u043e \u0433\u043b\u0430\u0432\u043d\u043e\u0435 \u0444\u043e\u0442\u043e \u0442\u043e\u0432\u0430\u0440\u0430" data-image="'+b.product_cut_images[d]+'" data-id="'+a+'">1</div>',c+=1!=d?'<div class="set-second-image" title="\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0432\u0442\u043e\u0440\u044b\u043c" data-image="'+b.product_cut_images[d]+'" data-id="'+a+'">2</div>':'<div class="already-second" title="\u042d\u0442\u043e \u0444\u043e\u0442\u043e \u0442\u043e\u0432\u0430\u0440\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 \u043a\u0443\u0440\u0441\u043e\u0440\u0430 \u043d\u0430 \u0442\u043e\u0432\u0430\u0440">2</div>'),c+='<a href="'+b.product_images[d].split("80x80").join("original")+'">',c+='<img src="'+b.product_images[d]+'">',c+="</a>",c+="</div>"}c+="</div>",c+="</div>",c+="</div>",c+='<div class="carousel-button-right"><a></a></div>',$("#product-images #product-images-box").first().append(c)})},admin.news={},admin.news.init=function(){loadmore.init("news_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.news.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.news.createElement(c),$(".admin-table tbody").append(b)})})},admin.news.add=function(){var a={};a.preview="",a.title="",a.text=$("#window textarea").val(),common.ajax({"with":"news",what:"add",news:a},function(b){console.log(b),a=b,a.news_views=0,a.news_date="\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e",$(".admin-table tbody").append(admin.news.createElement(a)),win.hide()})},admin.news.createElement=function(a){var b="";return b+='<tr class="news" data-id="'+a.news_id+'">',b+='<td class="news-preview">',b+='<input value="'+a.news_preview+'">',b+="</td>",b+='<td class="news-title">',b+='<input value="'+a.news_title+'">',b+="</td>",b+='<td class="news-text">',b+="<textarea>"+a.news_text+"</textarea>",b+="</td>",b+='<td class="news-public">',b+="<select>",b+='<option value="1"',1==a.news_public&&(b+=' selected="selected"'),b+=">\u0414\u0410</option>",b+='<option value="0"',a.news_public&&0!=a.news_public||(b+=' selected="selected"'),b+=">\u041d\u0415\u0422</option>",b+="</select>",b+="</td>",b+='<td class="news-views">'+a.news_date+"</td>",b+='<td class="news-views">',b+=a.news_views?a.news_views:0,b+="</td>",b+='<td class="options"><div class="remove">&#215;</div></td>',b+="</tr>"},admin.users={},admin.users.init=function(){loadmore.init("user_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.users.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.users.createElement(c),$(".admin-table tbody").append(b)})})},admin.users.add=function(){var a={};a.text=$("#window textarea").val(),common.ajax({"with":"users",what:"add",element:a},function(b){console.log(b),a.id=b,a.views=0,a.date="\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e",admin.users.createElement(a)})},admin.users.createElement=function(a){var b;return b='<tr class="users" data-id="'+a.user_id+'">',b+='<td class="users-first-name"><input placeholder="\u2014" value="',a.user_first_name&&(b+=a.user_first_name),b+='"></td>',b+='<td class="users-last-name"><input placeholder="\u2014" value="',a.user_last_name&&(b+=a.user_last_name),b+='"></td>',b+='<td class="users-email"><input disabled placeholder="\u2014" value="',a.user_email&&(b+=a.user_email),b+='"></td>',b+='<td class="users-sex"><select>',b+='<option value="0"',0==a.user_sex&&(b+='selected="selected"'),b+=">\u2014</option>",b+='<option value="1"',1==a.user_sex&&(b+='selected="selected"'),b+=">\u041c</option>",b+='<option value="2"',2==a.user_sex&&(b+='selected="selected"'),b+=">\u0416</option>",b+="</td>",b+='<td class="users-reset-pass"><a class="reset-user-pass">\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c</a></td>',b+='<td class="options"><div class="remove">&#215;</div></td>',b+="</tr>"},admin.articles={},admin.articles.init=function(){loadmore.init("article_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.articles.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.articles.createElement(c),$(".admin-table tbody").append(b)})})},admin.articles.add=function(){var a={};a.text=$("#window textarea").val(),common.ajax({"with":"articles",what:"add",article:a},function(b){console.log(b),a=b,a.views=0,a.date="\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e",$(".admin-table tbody").append(admin.articles.createElement(a)),win.hide()})},admin.articles.createElement=function(a){var b="";return b+='<tr class="article" data-id="'+a.article_id+'">',b+='<td class="article-title">',b+='<input placeholder="\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0441\u0442\u0430\u0442\u044c\u0438" value="',a.article_title&&(b+=a.article_title),b+='">',b+="</td>",b+='<td class="article-text">',b+="<textarea>"+a.article_text+"</textarea>",b+="</td>",b+='<td class="article-public">',b+="<select>",b+='<option value="1"',1==a.article_public&&(b+=' selected="selected"'),b+=">\u0414\u0410</option>",b+='<option value="0"',a.article_public&&0!=a.article_public||(b+=' selected="selected"'),b+=">\u041d\u0415\u0422</option>",b+="</select>",b+="</td>",b+='<td class="article-views">'+a.article_date+"</td>",b+='<td class="article-views">',b+=a.article_views?a.article_views:0,b+="</td>",b+='<td class="options"><div class="remove">&#215;</div></td>',b+="</tr>"},admin.infopages={},admin.infopages.init=function(){loadmore.init("infopage_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.infopages.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.infopages.createElement(c),$(".admin-table tbody").append(b)})})},admin.infopages.add=function(){var a={};a.link=$("#window input[name=name]").val(),a.text=$("#window textarea").val(),common.ajax({"with":"infopages",what:"add",infopage:a},function(b){console.log(b),a=b,a.public=0,a.views=0,$(".admin-table tbody").append(admin.infopages.createElement(a)),win.hide()})},admin.infopages.createElement=function(a){var b="";return b+='<tr class="infopages" data-id="'+a.infopage_id+'">',b+='<td class="infopages-text">',b+="<textarea>"+a.infopage_text+"</textarea>",b+="</td>",b+='<td class="infopages-show">',b+="<select>",b+='<option value="1"',1==a.infopage_public&&(b+=' selected="selected"'),b+=">\u0414\u0410</option>",b+='<option value="0"',0==a.infopage_public&&(b+=' selected="selected"'),b+=">\u041d\u0415\u0422</option>",b+="</select>",b+="</td>",b+='<td class="infopages-views">'+a.infopage_views+"</td>",b+='<td class="options"><div class="remove">&#215;</div></td>',b+="</tr>"},admin.options={},admin.options.init=function(){loadmore.init("option_id",0,16,function(a){var b;$.each(a,function(a,c){b=admin.options.createElement(c),$(".admin-table tbody").append(b)})}),loadmore.call(function(a){var b;$.each(a,function(a,c){b=admin.options.createElement(c),$(".admin-table tbody").append(b)})})},admin.options.createElement=function(a){var b;switch(b='<tr class="options" data-id="'+a.option_id+'">',b+='<td class="options-name">',a.option_name){case"shop_phone":b+="\u0422\u0435\u043b\u0435\u0444\u043e\u043d:";break;case"shop_mode":b+="\u0420\u0435\u0436\u0438\u043c \u0440\u0430\u0431\u043e\u0442\u044b:";break;case"shop_email":b+="E-mail:";break;case"shop_description":b+="\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430:";break;case"partnership_button":b+="\u041d\u0430\u0434\u043f\u0438\u0441\u044c \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0435:";break;case"shop_address":b+="\u0410\u0434\u0440\u0435\u0441 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430:";break;case"shop_copyright":b+="\u041a\u043e\u043f\u0438\u0440\u0430\u0439\u0442:";break;case"shop_name":b+="\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430:";break;case"items_per_page":b+="\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435:";break;case"colors-count":b+="\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0446\u0432\u0435\u0442\u043e\u0432 \u0432 \u043f\u0430\u043b\u0438\u0442\u0440\u0435:";break;case"module-auth":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438";break;case"module-cart":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u043a\u043e\u0440\u0437\u0438\u043d\u044b";break;case"module-filters":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432";break;case"module-search":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u043f\u043e\u0438\u0441\u043a\u0430";break;case"module-social":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u0441\u043e\u0446. \u0441\u0435\u0442\u0435\u0439";break;case"module-discounts":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u0441\u043a\u0438\u0434\u043e\u043a";break;case"module-reviews":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u043e\u0442\u0437\u044b\u0432\u043e\u0432";break;case"module-buymore":b+='\u041c\u043e\u0434\u0443\u043b\u044c "\u0441 \u044d\u0442\u0438\u043c \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u043a\u0443\u043f\u0430\u044e\u0442"';break;case"module-pluses":b+='\u041c\u043e\u0434\u0443\u043b\u044c "\u043f\u043b\u044e\u0441\u044b \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438"';break;case"module-characteristics":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u0442\u043e\u0432\u0430\u0440\u0430";break;case"module-avatar":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439";break;case"module-profitable":b+='\u041c\u043e\u0434\u0443\u043b\u044c "\u0432\u044b\u0433\u043e\u0434\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f"';break;case"module-news":b+="\u041c\u043e\u0434\u0443\u043b\u044c \u043d\u043e\u0432\u043e\u0441\u0442\u0435\u0439 \u0441\u0430\u0439\u0442\u0430";break;default:b+=a.option_name}return b+="</td>",b+='<td class="options-value"><input value="',b+=a.option_value,b+='">',b+="</tr>"},common.init=function(){jQ.loading=$("#loading"),$.ajaxSetup({url:"admin",type:"post",error:function(a){console.log(a)}}),common.events.init(),$.fn.fancyzoom.defaultsOptions.imgDir=window.fancyImgDir,$("a.tozoom").fancyzoom({Speed:1e3}),$("a").fancyzoom({overlay:.8})},common.events={},common.events.init=function(){common.events.click(),common.events.focusin(),common.events.focusout(),common.events.change(),common.events.mouseenter(),common.events.mouseleave(),common.events.scroll()},common.events.scroll=function(){var a=0;$(window).scroll(function(b){me=$(b.target);var c=$(this).scrollTop();if(c>a){if(me.is(".carousel-button-right a")){var d=$(".carousel");common.carusel.toRight(d)}}else if(me.is(".carousel-button-left a")){var d=$(".carousel");common.carusel.toLeft(d)}a=c})},common.events.mouseenter=function(){$(document).on("mouseenter",function(a){var b=$(a.target);b.is(".carousel")&&b.addClass("hover")})},common.events.mouseleave=function(){$(document).on("mouseleave",function(a){var b=$(a.target);b.is(".carousel")&&b.removeClass("hover")})},common.events.click=function(){$(document).on("click",function(a){a=a||window.event;var b=$(a.target),c=b.closest("tr"),d=c.data("id");if(b.is(".category-name input, .category-url input"))b.focus();else if(b.is("#product-image"))console.log("[common.events.click] :: OK :: .product_image"),c.find("input[type=file]").click();else if(b.is(".product-name-title"))admin.products.sortById();else if(b.is(".product-category-title"))admin.products.sortByCategory();else if(b.is(".product-subcategory-title"))admin.products.sortBySubcategory();else if(b.is("#add-product-image-button"))console.log("[common.events.click] :: OK :: #add-product-image-button"),c.find("input[type=file]").click();else if(b.is("#drop input"))console.log("[common.events.click] :: OK :: #drop input");else if(b.is("#products .remove")){console.log("[common.events.click] :: OK :: #products .remove");var e="products",f="remove"}else if(b.is("#products .product-details")){var e="products",f="details",b=$("#product-details");win.show(function(){win.title.set($("#msg-product-details-title").text()),win.content.set($("#msg-product-details-body"))}),$("#details-loading").show(),common.ajax({"with":e,what:f,id:d},function(a){$("#details-loading").hide(),$("#product-details").data("product-id",d),$("#product-details input[type=file]").attr({name:"product_image-"+a.product_id}),$("#product-details #product-image").attr({src:a.product_images}),$("#product-details .product-description").val(a.product_description),$("#product-details .product-delivery").val(a.product_delivery),$("#product-details .product-characteristics").val(a.product_details);for(var b=a.product_colors.split(","),c=0;c<b.length;c++)$("#filter-colors .filter-color[data-color="+b[c].substr(6)+"]").addClass("active")})}else if(b.is(".carousel-items img"))a.preventDefault(),"/site/gcorp/images/products/no-image.png"!=b.attr("src")&&b.closest("a").fancyzoom().click();else if(b.is(".admin-table .product-images"))admin.products.images(d);else if(b.is("#product-images .image-color")){var g=b.data("color"),h=g+1;h>14&&(h=0),b.data("color",h),b.removeClass("color-"+g),b.addClass("color-"+h),common.ajax({"with":"products",what:"set-image-color",id:b.data("product"),change:b.data("image"),set:"color-"+h},function(){console.log("answer")})}else if(b.is(".product-image-remove"))confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435?")&&admin.products.removeProductImage(b);else if(b.is(".set-main-image"))admin.products.setMainImage(b);else if(b.is(".set-second-image"))admin.products.setSecondImage(b);else if(b.is(".carousel-button-right a")){var i=$(".carousel");common.carusel.toRight(i)}else if(b.is(".carousel-button-left a")){var i=$(".carousel");common.carusel.toLeft(i)}else if(b.is("#product-details-save"))console.log("\u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u044f\u0441 \u043f\u043e onchange, \u043a\u043d\u043e\u043f\u043a\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043e\u043a\u043d\u043e"),win.hide();else if(b.is("#categories .remove")){console.log("[common.events.click] :: OK :: #categories .remove");var e="categories",f="remove"}else if(b.is("#products .product-add"))console.log("[common.events.click] :: OK :: #products .product-add"),win.show(function(){win.title.set($("#msg-product-add-title").text()),win.content.set($("#msg-product-add"))});else if(b.is("#window #product-add-button"))console.log("[common.events.click] :: OK :: #window #product-add-button"),admin.products.add();else if(b.is("#categories .category-add"))console.log("[common.events.click] :: OK :: #categories .category-add"),win.show(function(){win.title.set($("#msg-category-add-title").text()),win.content.set($("#msg-category-add"))});else if(b.is("#window #category-add-button"))console.log("[common.events.click] :: OK :: #window #category-add-button"),admin.categories.add();else if(b.is("#infopages-table .infopages-add"))console.log("[common.events.click] :: OK :: #infopages-table .infopages-add"),win.show(function(){win.title.set($("#msg-info-add-title").text()),win.content.set($("#msg-info-add"))});else if(b.is("#window #info-add-button"))console.log("[common.events.click] :: OK :: #window #info-add-button"),admin.infopages.add();else if(b.is("#users-table .reset-user-pass")){var e="users",f="reset-pass";confirm("\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0441\u0431\u0440\u043e\u0441 \u043f\u0430\u0440\u043e\u043b\u044f")&&(console.log("\u0417\u0430\u043f\u0440\u043e\u0448\u0435\u043d \u0441\u0431\u0440\u043e\u0441 \u043f\u0430\u0440\u043e\u043b\u044f, \u043d\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u043f\u043e\u043a\u0430 \u043d\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d"),alert("\u041f\u0430\u0440\u043e\u043b\u044c \u0441\u0431\u0440\u043e\u0448\u0435\u043d, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442 \u043f\u0438\u0441\u044c\u043c\u043e \u0441 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435\u043c"))}else if(b.is("#users-table .remove")){console.log("[common.events.click] :: OK :: #users-table .remove");var e="users",f="remove"}else if(b.is("#articles-table .remove")){console.log("[common.events.click] :: OK :: #articles-table .remove");var e="articles",f="remove"}else if(b.is("#news-table .remove")){console.log("[common.events.click] :: OK :: #news-table .remove");var e="news",f="remove"}else if(b.is("#infopages-table .remove")){console.log("[common.events.click] :: OK :: #infopages-table .remove");var e="infopages",f="remove"}else if(b.is("#window #product-add-button"))console.log("[common.events.click] :: OK :: #window #product-add-button"),admin.products.add();else if(b.is("#news-table .news-add"))console.log("[common.events.click] :: OK :: #news-table .news-add"),win.show(function(){win.title.set($("#msg-news-add-title").text()),win.content.set($("#msg-news-add"))});else if(b.is("#window #news-add-button"))console.log("[common.events.click] :: OK :: #window #news-add-button"),admin.news.add();else if(b.is("#articles-table .articles-add"))console.log("[common.events.click] :: OK :: #articles-table .articles-add"),win.show(function(){win.title.set($("#msg-articles-add-title").text()),win.content.set($("#msg-articles-add"))});else if(b.is("#window #articles-add-button"))console.log("[common.events.click] :: OK :: #window #articles-add-button"),admin.articles.add();else if(b.is("#product-images .filter-color"))$(".filter-color").removeClass("active"),b.addClass("active"),$("#product-images #images-color").val("color_"+b.data("color"));else if(b.is("#product-details .filter-color")){b.toggleClass("active");var j="";$("#product-details .filter-color").each(function(){$(this).hasClass("active")&&(j+=",color_"+$(this).data("color"))}),common.ajax({"with":"products",what:"update",id:$("#product-details").data("product-id"),change:"product_colors",set:j.substr(1)},function(a){1==a?console.log("colors in stock successfully refreshed"):console.log("error :: colors in stock bad response")})}else if(b.is("#news-table .news-text span")){console.log("[common.events.click] :: OK :: #news-table .news-text span");var c=b.closest("tr");c.html("<textarea autofocus>"+b.text()+"</textarea>"),c.find("textarea").focus()}else console.log("[common.events.click] :: unknown clicked element");"remove"==f&&confirm("\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435")&&common.ajax({"with":e,what:f,id:d},function(){c.remove()})})},common.events.focusin=function(){$(document).on("focusin",function(a){var b=$(a.target);b.is("input, textrea")&&(b.data("previous-value",b.val()),b.data("placeholder",b.attr("placeholder")),b.attr("placeholder",""))})},common.events.focusout=function(){$(document).on("focusout",function(a){var b=$(a.target);b.is("input, textrea")&&b.attr("placeholder",b.data("placeholder"))})},common.events.change=function(){$(document).on("change",function(a){var b=$(a.target),c=b.closest("tr"),d=c.data("id"),e=b.val(),f="",g="",h=!1;return b.is("#categories .category-name input")?(f="category_name",g="categories",h=!0):b.is("#categories .category-url input")?(f="category_url",g="categories",h=!0):b.is("#options .options-value input")?(f="option_value",g="options",h=!0):b.is(".admin-table .product-name input")?(f="product_name",g="products",h=!0):b.is(".admin-table .product-price input")?(f="product_price",g="products"):b.is(".admin-table .product-old-price input")?(f="product_old_price",g="products"):b.is(".admin-table .news-preview input")?(f="news_preview",g="news"):b.is(".admin-table .news-title input")?(f="news_title",g="news"):b.is(".admin-table .news-text textarea")?(f="news_text",g="news"):b.is(".admin-table .news-public select")?(f="news_public",g="news"):b.is(".admin-table .article-title input")?(f="article_title",g="articles"):b.is(".admin-table .article-text textarea")?(f="article_text",g="articles"):b.is(".admin-table .article-public select")?(f="article_public",g="articles"):b.is(".admin-table .infopages-show select")?(f="infopage_public",g="infopages"):b.is(".admin-table .infopages-text textarea")?(f="infopage_text",g="infopages"):b.is(".admin-table .product-category select")?(f="category_id",g="products"):b.is(".admin-table .product-subcategory select")?(f="product_subcategory_id",g="products"):b.is(".admin-table .product-type select")?(f="product_type",g="products","discount"==e?c.find(".product-old-price input").prop("disabled",!1):c.find(".product-old-price input").prop("disabled",!0)):b.is(".admin-table .users-first-name input")?(f="user_first_name",g="users"):b.is(".admin-table .users-last-name input")?(f="user_last_name",g="users"):b.is(".admin-table .users-sex select")?(f="user_sex",g="users"):b.is("#product-details .product-characteristics")?(f="details",g="products_details",d=$("#product-details").data("product-id")):b.is("#product-details .product-description")?(f="product_description",g="products",d=$("#product-details").data("product-id")):b.is("#product-details .product-delivery")?(f="product_delivery",g="products",d=$("#product-details").data("product-id")):b.is("#product-images input[type=file]")&&(b.val()?$("#product-image").attr("src","/site/admin/images/plus-ok.png"):$("#product-image").attr("src","/site/admin/images/add-file.png")),!e&&h?(alert("\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!"),b.val(b.data("previous-value")),console.log("[common.events.change] :: changed field is empty"),!1):(f?common.ajax({"with":g,what:"update",id:d,change:f,set:e},function(a){"category_id"===f&&$(".product[data-id="+d+"]").find(".product-subcategory").html(admin.products.selectSubcategory(a.set)),b.val(e),"product_name"==f&&$('.product[data-id="'+a.id+'"] .product-id input').val(a.id+a.set.substr(0,2).toUpperCase()),b.data("previous-value",b.val())
});console.log("[common.events.change] :: changed field is not in send-list"),void 0)})},common.events.select=function(){$(document).on("select",function(a){a=a||window.event;var b=$(a.target),c=b.closest("tr"),d=c.data("id"),e=b.val(),f="";b.is("#products .product-category select")?f="product_category":b.is("#products .product-type select")?f="product_type":(f=!1,console.log("[common.events.select] :: unknown selected element")),f&&common.ajax({"with":"products",what:"update",id:d,change:f,set:e},function(){b.val(e)})})},common.menu={},common.menu.init=function(){jQ.menu=$("#menu"),jQ.submenu={},jQ.submenu.all=$(".submenu"),jQ.submenu.pages=$("#submenu-link-pages"),$("#menu ul > li").on("click",function(){var a=$(this).find("a").attr("href");a&&(location=a)}),jQ.menu.find("ul > li").on("mouseenter",function(){var a=$(this);switch(a.find("a").attr("id")){case"menu-link-pages":jQ.submenu.pages.show(300)}}),jQ.menu.find(".submenu").on("mouseleave",function(){jQ.submenu.all.hide()}),$(document).on("click",function(){jQ.submenu.all.hide()})},common.ajax=function(a,b,c,d){$.ajax({data:{"do":a},beforeSend:function(){d&&"function"==typeof d&&d()},success:function(a){if(a){var d;try{d=jQuery.parseJSON(a)}catch(e){console.log("[common.ajax] :: fail :: json.parse error:"),console.log(a),c&&"function"==typeof c&&c()}d&&(d.fail?(console.log("[common.ajax] :: fail :: server error :: "+d.fail),console.log(d),"access-denied"==d.fail&&confirm("\u0412\u0440\u0435\u043c\u044f \u0441\u0435\u0441\u0441\u0438\u0438 \u0438\u0441\u0442\u0435\u043a\u043b\u043e. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0437\u0430\u043d\u043e\u0432\u043e.")&&location.reload(),c&&"function"==typeof c&&c(d)):b&&"function"==typeof b&&b(d))}else console.log("[common.ajax] :: fail :: empty server response")}})};var loadmore={};loadmore.options={},loadmore.init=function(a,b,c,d){console.log("success :: loadmore.init()"),loadmore.restart(a,b,c,d),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>=$(document).height()-200&&!loadmore.options.inProgress&&loadmore.call(d)})},loadmore.restart=function(a,b,c,d){d&&"function"==typeof d?(loadmore.options.onPage=c,loadmore.options.sortBy=a,loadmore.options.unable=!1,loadmore.options.inProgress=!1,loadmore.options.startFrom=b,loadmore.options.from=page):console.error("error :: incorrect calling loadmore.init()")},loadmore.call=function(a){loadmore.options.unable||common.ajax({"with":"loadMore",from:loadmore.options.from,sort:loadmore.options.sortBy,start:loadmore.options.startFrom,quantity:loadmore.options.onPage},function(b){jQ.loading.hide(),b.length>0?("function"==typeof a&&a(b),loadmore.options.inProgress=!1,loadmore.options.startFrom+=loadmore.options.onPage):b||(console.log("\u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0435\u0447\u0435\u0433\u043e \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c"),loadmore.options.unable=!0)},function(){jQ.loading.hide(),console.log("[loadmore.call] :: ajax.fail")},function(){jQ.loading.show(),loadmore.options.inProgress=!0})},$(function(){function b(a){return"number"!=typeof a?"":a>=1073741824?(a/1073741824).toFixed(2)+" GB":a>=1048576?(a/1048576).toFixed(2)+" MB":(a/1024).toFixed(2)+" KB"}var a=$("#upload ul");$("#upload").fileupload({dropZone:$("#drop"),add:function(c,d){d.autoUpload=!0;var e=$('<li class="working"><input type="text" value="0" data-width="48" data-height="48" data-fgColor="#0788a5" data-readOnly="1" data-bgColor="#3e4043" /><p></p><span></span></li>');e.find("p").text(d.files[0].name).append("<i>"+b(d.files[0].size)+"</i>"),d.context=e.appendTo(a),e.find("input[type=file]").knob(),e.find("span").click(function(){e.hasClass("working")&&f.abort(),e.fadeOut(function(){e.remove()})});var f=d.submit()},progress:function(a,b){var c=parseInt(100*(b.loaded/b.total),10);b.context.find("input").val(c).change(),100==c&&b.context.removeClass("working")},fail:function(a,b){b.context.addClass("error")}}),$(document).on("drop dragover",function(a){a.preventDefault()})}),common.carusel={},common.carusel.toLeft=function(a){var b=$(a).find(".carousel-block").outerWidth();$(a).find(".carousel-items .carousel-block").eq(-1).clone().prependTo($(a).find(".carousel-items")),$(a).find(".carousel-items").css({left:"-"+b+"px"}),$(a).find(".carousel-items .carousel-block").eq(-1).remove(),$(a).find(".carousel-items").animate({left:"0px"},200)},common.carusel.toRight=function(a){var b=$(a).find(".carousel-block").outerWidth();$(a).find(".carousel-items").animate({left:"-"+b+"px"},200,function(){$(a).find(".carousel-items .carousel-block").eq(0).clone().appendTo($(a).find(".carousel-items")),$(a).find(".carousel-items .carousel-block").eq(0).remove(),$(a).find(".carousel-items").css({left:"0px"})})};